# Linux Malwares

## ELF headers manipulation

Attacker will tamper with the ELF headers as an anti-analysis. There are two types of modifications:

### Anomalous ELF

Files which follow the ELF specification but usually won't be generated by traditional compilers. 

Examples:

- Removing all information about the ELF sections - sections information are not used at runtime, therefore the file could be executed.
- False information - filling fields with false information such as, different operation system at system API field.

### Invalid ELF

Files that contains invalid data but still could run on the system. Usually achieved by supply invalid data into `e_shoff`, `e_shnum`, `e_shentsize`, etc.

Examples:
- Section header table pointing beyond file data
- Wrong string table index (`e_ehstrndx`) 
- Overlapping ELF header/segment
- Invalid pointers - segment header table pointing beyond file data

*ELF Parsers:*

- readelf 
- pyelftools
- GDB
- IDA Pro

## Persistence

Malware will use the following techniques in order to achieve persistence.